svg(version='1.1', baseProfile='full', viewBox='0 0 700 500', xmlns='http://www.w3.org/2000/svg', xmlns:xlink="http://www.w3.org/1999/xlink")
  defs
    style.
      text { font-family: 'Old Standard TT'; font-style: italic; }
    marker#Triangle(viewBox='0 0 10 10', refX=1, refY=5, markerWidth=4, markerHeight=4, orient='auto-start-reverse')
      path(d='M 0 0 L 10 5 L 0 10 z')
  rect(x=0, y=0, width='100%', height='100%', stroke='black', fill-opacity=0)
  -
    var anims = [
      [[0, 0, 1, 1], [0, 0.1, 0.2, 1]],
      [[0, 0, 1, 1], [0, 0.8, 0.9, 1]],
      [[0, 0, 1, 1], [0, 0.8, 0.9, 1]],
      [[0, 0, 1, 1], [0, 0.5, 0.6, 1]],
    ];
    var labels = ['a0', 'a1', 'a2', '...']
  - for (var i = 0; i < 3; i++) {
    rect(x=10, y=10 + i * 120, width=120, height=100, stroke='black', fill-opacity=0)
    text(x=70, y=55 + i * 120, text-anchor='middle')= 'client ' + i
    line(x1=150, x2=400, y1=60+i*120, y2=60+i*120, marker-end='url(#Triangle)', marker-start='url(#Triangle)', stroke='black', stroke-width=3)
    - for (var j = 0; j < 4; j++) {
      rect(x=20+j*20, y=85+i*120, width=20, height=20, stroke='black', fill-opacity=0)
      text(x=30+j*20, y=100+i*120, text-anchor='middle', font-size=12)= labels[j]
    - }
    g
      rect(x=100, y=85+i*120, width=20, height=20, stroke='red', fill-opacity=0)
      text(x=110, y=100+i*120, text-anchor='middle', font-size=12, fill='red') ai
      animate(dur='20s', attributeName='opacity', attributeType='XML', values=anims[i][0].join(';'), keyTimes=anims[i][1].join(';'), repeatCount='indefinite')
  - }
  rect(x=430, y=10, width=120, height=340, stroke='black', fill-opacity='0')
  text(x=490, y=100, text-anchor='middle') server
  - for (var j = 0; j < 4; j++) {
    rect(x=440+j*20, y=85+120, width=20, height=20, stroke='black', fill-opacity=0)
    text(x=450+j*20, y=100+120, text-anchor='middle', font-size=12)= labels[j]
  - }
  g
    rect(x=520, y=85+120, width=20, height=20, stroke='green', fill-opacity=0)
    text(x=530, y=100+120, text-anchor='middle', font-size=12, fill='green') ai
    animate(dur='20s', attributeName='opacity', attributeType='XML', values=anims[3][0].join(';'), keyTimes=anims[3][1].join(';'), repeatCount='indefinite')
  g
    rect(x=0, y=0, width=20, height=20, stroke='blue', fill-opacity=0)
    text(x=10, y=15, text-anchor='middle', font-size=12, fill='blue') ai
    animateMotion(dur='20s', repeatCount='indefinite', calcMode='linear', path='M 100 55 L 100 85 L 520 205', keyPoints='0;1;1', keyTimes='0;.5;1')
    animate(attributeName='opacity', attributeType='XML', values='1;1;0;0', keyTimes='0;.45;.5;1', dur='20s', repeatCount='indefinite')
  g
    rect(x=0, y=0, width=20, height=20, stroke='green', fill-opacity=0)
    text(x=10, y=15, text-anchor='middle', font-size=12, fill='green') ai
    animateMotion(dur='20s', repeatCount='indefinite', calcMode='linear', path='M 520 205 L 100 85', keyPoints='0;0;1;1', keyTimes='0;.5;.8;1')
    animate(attributeName='opacity', attributeType='XML', values='0;0;1;1', keyTimes='0;.5;.55;1', dur='20s', repeatCount='indefinite')
  g
    rect(x=0, y=0, width=20, height=20, stroke='green', fill-opacity=0)
    text(x=10, y=15, text-anchor='middle', font-size=12, fill='green') ai
    animateMotion(dur='20s', repeatCount='indefinite', calcMode='linear', path='M 520 205 L 100 205', keyPoints='0;0;1;1', keyTimes='0;.5;.8;1')
    animate(attributeName='opacity', attributeType='XML', values='0;0;1;1', keyTimes='0;.5;.55;1', dur='20s', repeatCount='indefinite')
  g
    rect(x=0, y=0, width=20, height=20, stroke='green', fill-opacity=0)
    text(x=10, y=15, text-anchor='middle', font-size=12, fill='green') ai
    animateMotion(dur='20s', repeatCount='indefinite', calcMode='linear', path='M 520 205 L 100 325', keyPoints='0;0;1;1', keyTimes='0;.5;.8;1')
    animate(attributeName='opacity', attributeType='XML', values='0;0;1;1', keyTimes='0;.5;.55;1', dur='20s', repeatCount='indefinite')
